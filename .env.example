# =============================================================================
# UNMAPPED OS - ENVIRONMENT CONFIGURATION
# Strategy 6.0++ Production-Grade System
# =============================================================================
# SECURITY: Never commit this file. Copy to .env and fill in secrets.
# =============================================================================

# -----------------------------------------------------------------------------
# PHASE 0: FOUNDATION
# -----------------------------------------------------------------------------

# Application URLs
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_DOMAIN=unmappedos.com
NEXT_PUBLIC_APP_NAME=UNMAPPED OS
NEXT_PUBLIC_APP_VERSION=6.0.0

# Node Environment
NODE_ENV=development

# -----------------------------------------------------------------------------
# SUPABASE (AUTHENTICATION & DATABASE)
# -----------------------------------------------------------------------------
# Get these from: https://app.supabase.com/project/_/settings/api
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here # SERVER-ONLY: Never expose

# -----------------------------------------------------------------------------
# OAUTH PROVIDERS (PHASE 0.2)
# -----------------------------------------------------------------------------
# Google OAuth: https://console.cloud.google.com/apis/credentials
NEXT_PUBLIC_GOOGLE_ENABLED=false
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# GitHub OAuth: https://github.com/settings/developers
NEXT_PUBLIC_GITHUB_ENABLED=false
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# Apple OAuth: https://developer.apple.com/account/resources/identifiers/list/serviceId
NEXT_PUBLIC_APPLE_ENABLED=false
APPLE_CLIENT_ID=
APPLE_TEAM_ID=
APPLE_KEY_ID=
APPLE_PRIVATE_KEY=

# -----------------------------------------------------------------------------
# MAP PROVIDERS (PHASE 1.3)
# -----------------------------------------------------------------------------
# Mapbox (Primary)
NEXT_PUBLIC_MAPBOX_TOKEN=pk.your-mapbox-token-here
NEXT_PUBLIC_MAPBOX_STYLE=mapbox://styles/mapbox/dark-v11

# MapLibre/Maptiler (Fallback - FREE TIER)
NEXT_PUBLIC_MAPLIBRE_STYLE_URL=https://api.maptiler.com/maps/streets/style.json?key=your-key
NEXT_PUBLIC_MAPTILER_KEY=your-maptiler-key-here

# Map Preference: mapbox | maplibre
NEXT_PUBLIC_MAP_PROVIDER=maplibre

# -----------------------------------------------------------------------------
# OVERPASS API (PHASE 1.1 - CITY PACK GENERATION)
# -----------------------------------------------------------------------------
OVERPASS_ENDPOINT=https://overpass-api.de/api/interpreter
OVERPASS_RATE_LIMIT_MS=2000
OVERPASS_TIMEOUT=90

# -----------------------------------------------------------------------------
# LOGGING (PHASE 0.4 - PRODUCTION STRUCTURED LOGGING)
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_FORMAT=pretty # pretty | json
LOG_REDACT=req.headers.authorization,user.email,user.phone,body.location,req.body.location

# Optional: Log Shipping (Production Only)
LOG_SHIP_S3=false
S3_LOG_BUCKET=unmappedos-logs
S3_LOG_REGION=us-east-1
S3_LOG_ACCESS_KEY_ID=
S3_LOG_SECRET_ACCESS_KEY=

# Optional: External Logging Services
LOG_SHIP_DATADOG=false
DATADOG_API_KEY=
LOG_SHIP_LOGDNA=false
LOGDNA_INGESTION_KEY=

# -----------------------------------------------------------------------------
# GAMIFICATION (PHASE 4)
# -----------------------------------------------------------------------------
GAMIFY_KARMA_COMMENT=10
GAMIFY_KARMA_PRICE=5
GAMIFY_KARMA_REPORT=15
GAMIFY_KARMA_VERIFIED=25
GAMIFY_KARMA_DAILY_CAP=200
GAMIFY_KARMA_ABUSE_THRESHOLD=500

# -----------------------------------------------------------------------------
# RATE LIMITING & SECURITY (PHASE 7)
# -----------------------------------------------------------------------------
RATE_LIMIT_EXPORT=5                    # Max exports per window
RATE_LIMIT_WINDOW=3600000              # Window in ms (1 hour)
RATE_LIMIT_API=100                     # Max API calls per minute
RATE_LIMIT_HAZARD_REPORT=5             # Max hazard reports per day

# CORS Configuration
CORS_ALLOWED_ORIGINS=http://localhost:3000,https://unmappedos.com

# Security
CRON_SECRET=generate-random-secret-here  # For protecting cron jobs
API_SECRET_KEY=generate-api-secret       # For server-to-server

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------
FEATURE_GAMIFICATION=true
FEATURE_ACTIVITY_EXPORT=true
FEATURE_OPERATIVE_MEMORY=true
FEATURE_CRISIS_MODE=true
FEATURE_SHADOW_MODE=true
FEATURE_GHOST_BEACONS=true
FEATURE_WHISPER_ENGINE=true
FEATURE_TEXTURE_SYSTEM=true

# -----------------------------------------------------------------------------
# CACHING & PERFORMANCE (PHASE 7)
# -----------------------------------------------------------------------------
# Redis (Optional - uses in-memory LRU if not configured)
REDIS_ENABLED=false
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_TLS=false

# Cache TTL (seconds)
CACHE_TTL_ZONE=3600                    # 1 hour
CACHE_TTL_USER_STATS=300               # 5 minutes
CACHE_TTL_PACK=604800                  # 7 days
CACHE_TTL_PRICES=60                    # 1 minute

# -----------------------------------------------------------------------------
# DATABASE & STORAGE (PHASE 7)
# -----------------------------------------------------------------------------
# Database Connection Pooling
DB_POOL_MIN=2
DB_POOL_MAX=10

# Supabase Storage (for pack CDN)
STORAGE_BUCKET_PACKS=city-packs
STORAGE_BUCKET_PHOTOS=user-photos

# -----------------------------------------------------------------------------
# PHASE 2: INTELLIGENCE LAYER
# -----------------------------------------------------------------------------
# Texture System
TEXTURE_UPDATE_INTERVAL=3600000        # 1 hour
TEXTURE_WEATHER_API_KEY=               # Optional: OpenWeather API

# Whisper Engine
WHISPER_MIN_INTEL_THRESHOLD=3          # Min intel pieces for whisper
WHISPER_CONFIDENCE_THRESHOLD=0.7       # Min confidence score

# Ghost Beacons
GHOST_BEACON_RADIUS=50                 # meters
GHOST_BEACON_MIN_INTEREST_SCORE=7      # Min score to trigger

# -----------------------------------------------------------------------------
# PHASE 3: MODERATION
# -----------------------------------------------------------------------------
# Kill Switch (Hazard Aggregation)
KILL_SWITCH_REPORT_THRESHOLD=2         # Reports needed to disable zone
KILL_SWITCH_TIME_WINDOW=86400000       # 24 hours in ms
KILL_SWITCH_OFFLINE_DURATION=604800000 # 7 days in ms

# Content Moderation
MODERATION_AUTO_HIDE_THRESHOLD=-5      # Auto-hide if trust score below
MODERATION_MANUAL_REVIEW_THRESHOLD=3   # Flag for manual review

# -----------------------------------------------------------------------------
# PHASE 5: MEMORY & PERSONALIZATION
# -----------------------------------------------------------------------------
# Operative Replay
REPLAY_MAX_ENTRIES=10000               # Max GPS snapshots per user
REPLAY_RETENTION_DAYS=90               # Days to keep replay data

# Texture Fingerprint
FINGERPRINT_MIN_ZONES_VISITED=10       # Min zones for fingerprint
FINGERPRINT_UPDATE_FREQUENCY=86400000  # Update daily

# -----------------------------------------------------------------------------
# PHASE 6: SAFETY & RESILIENCE
# -----------------------------------------------------------------------------
# Crisis Mode
CRISIS_TRIGGER_BATTERY=15              # % battery to auto-trigger
CRISIS_SHAKE_THRESHOLD=15              # Shake intensity (0-30)

# Shadow Copy Mode
SHADOW_MODE_ENABLED=true
SHADOW_MODE_NO_WRITES=true

# -----------------------------------------------------------------------------
# PHASE 8: CI/CD & MONITORING
# -----------------------------------------------------------------------------
# GitHub Actions
CI_SKIP_TESTS=false
CI_BUILD_TIMEOUT=600

# Monitoring
SENTRY_DSN=                            # Optional: Error tracking
SENTRY_ENV=development

# Analytics (Privacy-Safe)
ANALYTICS_ENABLED=false
PLAUSIBLE_DOMAIN=unmappedos.com        # Privacy-first analytics

# -----------------------------------------------------------------------------
# DEVELOPMENT & TESTING
# -----------------------------------------------------------------------------
# Test Database (for E2E tests)
TEST_SUPABASE_URL=
TEST_SUPABASE_KEY=

# Debug Flags
DEBUG_LOGGING=false
DEBUG_SKIP_RATE_LIMITS=false
DEBUG_MOCK_GPS=false
